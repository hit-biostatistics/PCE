setwd("D:/R")
library(ggplot2)
library(scatterplot3d)
library(Linnorm)
library(Rtsne)
library(mclust)
#函数
get_clusternum<-function(x){
  pca1<-princomp(x)$sdev
  sumsqr<-sum(pca1^2)
  psum=0
  i=1
  while(psum<=0.959){
    psum=psum+(pca1[[i]]^2)/(sumsqr)
    i=i+1
  }
  return(i=i-1)
}

do_linnorm<-function(x){
  ES<-Linnorm(unique(x))
  return(ES)
}


do_tsne<-function(x,dim,perplexity=15){
  RTS<-Rtsne(t(unique(x)),dims = dim,perplexity = perplexity )
  return(RTS$Y)
}


do_hierarchicalcluser<-function(x,clusternum){
  dist<-dist(x)
  hc<-hclust(dist,method="average")
  b<-cutree(hc,k=clusternum)
  #plot(x)
  #plot(x,col=b)
  return(list(hc,b))
}
#数据读取
a<-read.csv("Zeisel-fixed.csv",header = T)
a<-a[,-1]
a<-a[-1]
a<-unique(a)
max(a)
#a<-as.matrix(a)
#a<-as.numeric(a)
aa<-princomp(a)



  #kk<-read.csv("nsmb.2660-S31.csv",header = T)
  #kk<-read.csv("nsmb.2660-S21.csv",header = T)
  #kk<-kk[-2]
  #kk<-kk[-1]
  #kk<-kk[1:90]
  #kk2<-unique(kk)
  #ES1<-log2(as.matrix(kk)+1)
  #ES2<-Linnorm(kk)
  #  k1=7#######原论文分类
  #  k2=6#######SC3分类
  #a2<-c(rep(1,3),rep(2,3),rep(3,6),rep(4,12),rep(5,20),rep(6,16),rep(7,30))#######golden data "yan" 

  kk<-read.table("Goolam_et_al_2015_count_table.tsv",header = T)
  kk6<-unique(kk)
  #ES1<-log2(as.matrix(kk)+1)
  #ES2<-Linnorm(kk)
  #  k1=5
  #  k2=6
  a6<-c(rep(1,6),rep(2,40),rep(3,16),rep(4,6),rep(5,6),rep(3,16),rep(1,10),rep(2,24))###########golden data "goolam"
  
  
  
  
  ES<-do_linnorm(kk6)  
  ES2<-do_tsne(ES,2)
  ES3<-do_tsne(ES,3)
  x1=ES2[,1]
  y1=ES2[,2]
  ES2.da<-data.frame(x1,y1,hc=factor(a6))
  n<-get_clusternum(kk6)
  h<-do_hierarchicalcluser(ES2,n)
  hc<-factor(h[[2]])
  ES2.da2<-data.frame(x1,y1,hc)
  
  ggplot(data=ES2.da2,aes(x=x1,y=y1))+
  geom_point(size=3)+
  labs(x="tSNE1",y="tSNE2")+
  theme_bw()+
  theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()) 
  
  ggplot(data=ES2.da2,aes(x=x1,y=y1,shape=hc,color=hc))+
  geom_point(size=3)+
  labs(x="tSNE1",y="tSNE2")+theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank())
  
  
  ari.linnorm.goolam<-c(0.8830845,0.8830845,0.8746762,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8746762,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845)
  
  
  
  ari.pcaReduce.goolam<-c(0.16758116,0.27211554,0.24614616,0.16758116,0.20708118
                          ,0.24614616,0.27046470,0.16758116,0.30282325,0.27046470
                          ,0.27046470,0.22435275,0.24614616,0.27046470,0.24614616
                          ,0.24614616,0.24614616,0.24614616,0.16758116,0.27046470
                          ,0.16758116,0.28112116,0.22435275,0.22435275,0.30529620
                          ,0.16758116,0.22435275,0.27046470,0.22435275,0.27211554
                          ,0.27211554,0.22435275,0.24614616,0.24614616,0.16758116
                          ,0.24614616,0.24614616,0.22435275,0.16758116,0.27211554
                          ,0.27046470,0.20708118,0.30529620,0.24614616,0.16758116
                          ,0.24614616,0.30282325,0.22435275,0.13782490,0.22435275
                          ,0.30282325,0.27046470,0.20708118,0.13782490,0.30529620
                          ,0.24614616,0.18626272,0.16758116,0.24614616,0.16758116
                          ,0.27211554,0.27046470,0.27211554,0.24614616,0.24614616
                          ,0.27046470,0.16758116,0.16758116,0.18626272,0.16758116
                          ,0.27046470,0.22435275,0.14842204,0.10379343,0.22435275
                          ,0.13782490,0.22435275,0.27046470,0.21932303,0.24614616
                          ,0.24614616,0.16758116,0.22435275,0.22435275,0.13782490
                          ,0.16758116,0.18626272,0.27046470,0.24614616,0.16758116
                          ,0.30529620,0.16758116,0.27046470,0.24614616,0.22435275
                          ,0.24614616,0.24614616,0.24614616,0.24614616,0.06110472)
  
  
  
  ari.sc3.goolam<-c(0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447)
  
  
  ari.sincera.goolam<-c(0.354832)
  
  
  
  ari<-c(ari.linnorm.goolam,ari.pcaReduce.goolam,ari.sc3.goolam,ari.sincera.goolam)
  
  group<-factor(c(rep("my method",100),rep("pcaReduce",100),rep("SC3",100),"sincera"))
  
  ARI<-data.frame(ari,group)
  
 # ggplot(data=ARI,aes(x=group,y=ari))+
 #   geom_point(position="jitter")+
  #  stat_summary(fun.y=median,geom='bar')
  
  
  
  ggplot(data=ARI,aes(x=group,y=ari))+
    geom_bar(fun.y=median,stat="summary",fill=c("red","green","yellow","cornflowerblue"))+
    ylim(0,1)+
    geom_point(position="jitter")+
    labs(title="goolam",x="方法",y="ARI")+
    theme(plot.title = element_text(size=30,hjust=0.5),panel.background = element_blank())+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank())+
    theme(axis.line = element_line(size=1, colour = "black"))
    
  
  
  
  
  
  
  
  ###########################yan
  ari.linnorm.yan<-c(0.7509902,0.7509902,0.8246886,0.7509902,0.7509902,0.7848549
                     ,0.8246886,0.7509902,0.7671290,0.8246886,0.7509902,0.7365258
                     ,0.7848549,0.7509902,0.7671290,0.7671290,0.7509902,0.7365258
                     ,0.7509902,0.7509902,0.7509902,0.7509902,0.7509902,0.7509902
                     ,0.7509902,0.7509902,0.8930451,0.7509902,0.7848549,0.7365258
                     ,0.7509902,0.7671290,0.7238162,0.7671290,0.7365258,0.7365258
                     ,0.7509902,0.7039403,0.7509902,0.7509902,0.7671290,0.7509902
                     ,0.7129335,0.7671290,0.7509902,0.7848549,0.8246886,0.7848549
                     ,0.7509902,0.7509902,0.7671290,0.7509902,0.7509902,0.7509902
                     ,0.7848549,0.7509902,0.7671290,0.7365258,0.7509902,0.7671290
                     ,0.7509902,0.7509902,0.7509902,0.7509902,0.7509902,0.7509902
                     ,0.7509902,0.7509902,0.7238162,0.7848549,0.7671290,0.7671290
                     ,0.7509902,0.7509902,0.7509902,0.7848549,0.7671290,0.7509902
                     ,0.7509902,0.7509902,0.7509902,0.7129335,0.7509902,0.7509902
                     ,0.7238162,0.7509902,0.7509902,0.6205952,0.7509902,0.7365258
                     ,0.7509902,0.7509902,0.7509902,0.7509902,0.7671290,0.7129335
                     ,0.7509902,0.7509902,0.7509902,0.7039403)
  ari.linnorm.median.yan<-median(ari.linnorm.yan)
  
  ari.sc3.yan<-c(0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,
                 0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,
                 0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,
                 0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,
                 0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,
                 0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,
                 0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,
                 0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,
                 0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,
                 0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,
                 0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,
                 0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,0.7132715,
                 0.7132715,0.7132715,0.7132715,0.7132715
  )
  ari.sc3.median.yan<-median(ari.sc3.yan)
  
  ari.pcaReduce.yan<-c(0.4141171,0.4016604,0.3913602,0.3844938,0.4591419,0.5087459,0.5738857,0.6010446,
                       0.6132863,0.5449776,0.5757137,0.5406362,0.7093031,0.567638,0.6132863,0.4928596,
                       0.4483517,0.4016604,0.5449776,0.6353156,0.5593605,0.6307846,0.5211887,0.6010446,
                       0.5327795,0.5327795,0.376637,0.500009,0.4100333,0.5925323,0.4171697,0.4016604,
                       0.5845762,0.6739498,0.50185,0.6731398,0.36997,0.5406362,0.3844938,0.4100333,
                       0.4910295,0.4511745,0.4184486,0.5854968,0.4501457,0.5104117,0.5364572,0.3913602,
                       0.5593605,0.4994471,0.500009,0.4935388,0.4879879,0.500009,0.5140352,0.571032,
                       0.601737,0.5478176,0.3564777,0.4677784,0.3931993,0.5925323,0.3913602,0.6119507,
                       0.3899093,0.4843504,0.5563819,0.500009,0.6739498,0.4935388,0.495622,0.5405629,
                       0.361676,0.3913602,0.5321652,0.6190022,0.45878,0.546334,0.6010446,0.571032,
                       0.4105117,0.6316644,0.5334304,0.45878,0.5211887,0.5665043,0.5216145,0.45878,
                       0.6010446,0.36997,0.6316644,0.4325154,0.6010446,0.45878,0.571032,0.4885617,
                       0.5300827,0.5499234,0.4483517,0.601737)
  ari.pcaReduce.median.yan<-median(ari.pcaReduce.yan)
  
  ari.sincera.yan<-c(0.6152528)##########4类
  
  
  
  
  ########################biase
  ari.linnorm.biase<-c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
                       1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.7114144,
                       1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
                       1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.7114144,1,1,
                       1,1,1,1,1,1,1,1,1,0.6736234,1,1,1,1,1,1,1,1,
                       1,1,1,1,1)
  ari.linnorm.median.biase<-median(ari.linnorm.biase)
  ari.sc3.biase<-c(0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,
                   0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,
                   0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,
                   0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,
                   0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,
                   0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,
                   0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,
                   0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,
                   0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,
                   0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,
                   0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,0.9482629,
                   0.9482629)
  ari.sc3.median.biase<-median(ari.sc3.biase)
  
  
  ari.pcaReduce.biase<-c(0.3057133,0.3253460,0.7758463,0.5420218,0.3926415,0.7758463
                         ,0.5420218,0.3253460,0.3926415,0.3926415,0.3057133,0.3253460
                         ,0.5420218,0.3253460,0.5420218,0.3926415,0.3926415,0.7758463
                         ,0.7758463,0.3926415,0.7758463,0.7758463,0.7758463,0.5420218
                         ,0.7758463,0.3926415,0.7758463,0.7758463,0.3926415,0.5420218
                         ,0.5420218,0.3253460,0.3253460,0.3926415,0.5420218,0.7758463
                         ,0.5420218,0.3057133,0.5420218,0.3926415,0.7758463,0.7758463
                         ,0.7758463,0.3057133,0.7758463,0.3926415,0.3253460,0.7758463
                         ,0.3253460,0.3926415,0.3926415,0.3926415,0.3926415,0.3253460
                         ,0.5420218,0.7758463,0.7758463,0.5420218,0.7758463,0.3926415
                         ,0.3057133,0.3926415,0.3253460,0.7758463,0.7758463,0.3926415
                         ,0.7758463,0.3253460,0.3926415,0.3926415,0.3057133,0.3253460
                         ,0.3253460,0.7758463,0.3057133,0.5420218,0.7758463,0.5420218
                         ,0.7758463,0.7758463,0.3926415,0.3926415,0.5420218,0.7758463
                         ,0.3253460,0.7758463,0.7758463,0.7758463,0.7758463,0.5420218
                         ,0.3253460,0.7758463,0.7758463,0.3253460,0.3253460,0.3253460
                         ,0.3926415,0.3253460,0.3926415,0.3926415)
  ari.pcaReduce.median.biase<-median(ari.pcaReduce.biase)
  
  ari.sincera.biase<-c(1.0)################3类
  
  
  ############################treulein
  
  ari.linnorm.treu<-c(0.3427663,0.3154072,0.2756889,0.3270304,0.3334778,0.3473175,0.3152198,
                      0.3448547,0.2699232,0.3366567,0.4031482,0.3908354,0.3301217,0.2416863,
                      0.4086955,0.3256577,0.4331606,0.2974509,0.4663902,0.4276509,0.1612269,
                      0.2774683,0.2737455,0.3082639,0.374585,0.3160973,0.3051187,0.2548263,
                      0.3178896,0.3277873,0.3034304,0.4276509,0.3579837,0.3157596,0.08512093,
                      0.2845118,0.3318232,0.4120323,0.303339,0.2675632,0.3394474,0.3285456,
                      0.3154072,0.05135562,0.4006008,0.374585,0.4768367,0.3679524,0.3363183,
                      0.3747128,0.3722637,0.2695514,0.4105176,0.44936,0.3600809,0.2951449,
                      0.3732861,0.3303071,0.2662934,0.2919049,0.3262078,0.374585,0.3003126,
                      0.3629948,0.08176844,0.3778225,0.2667704,0.4447036,0.316446,0.3446628,
                      0.276873,0.3270304,0.3628225,0.3154072,0.3097738,0.2929823,0.384733,
                      0.3529693,0.3679524,0.4832766,0.3019897,0.3446628,0.3600809,0.3154072,
                      0.1252346,0.4276509,0.4726668,0.2818201,0.2875736,0.2578601,0.4286087,
                      0.05741298,0.3171423,0.374585,0.3757457,0.3908012,0.2623649,0.2277292,
                      0.04963906,0.3277873)
  ari.linnorm.median.treu<-median(ari.linnorm.treu)
  
  ari.sc3.treu<-c(0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,
                  0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,
                  0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,
                  0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,
                  0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,
                  0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,
                  0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,
                  0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,
                  0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,
                  0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,
                  0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,
                  0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,0.7692727,
                  0.7692727,0.7692727,0.7692727,0.7692727)
  ari.sc3.median.treu<-median(ari.sc3.treu)
  
  ari.pcaReduce.treu<-c(0.3077690,0.3485785,0.3485785,0.3485785,0.3485785,0.3485785,
                        0.3485785,0.3485785,0.3485785,0.3485785,0.3485785,0.3485785,
                        0.3485785,0.3485785,0.3077690,0.3485785,0.3077690,0.3121741,
                        0.3485785,0.3121741,0.3077690,0.3485785,0.3485785,0.3485785,
                        0.3077690,0.3485785,0.3485785,0.3485785,0.3077690,0.3485785,
                        0.3485785,0.3485785,0.3077690,0.3077690,0.3077690,0.3485785,
                        0.3077690,0.3077690,0.3485785,0.3485785,0.3077690,0.3077690,
                        0.3485785,0.3485785,0.3077690,0.3485785,0.3485785,0.3485785,
                        0.3077690,0.3485785,0.3077690,0.3485785,0.3077690,0.3485785,
                        0.3485785,0.3485785,0.3485785,0.3485785,0.3485785,0.3485785,
                        0.3485785,0.3077690,0.3077690,0.3485785,0.3485785,0.3485785,
                        0.3485785,0.3485785,0.3485785,0.3485785,0.3077690,0.3485785,
                        0.3077690,0.3485785,0.3485785,0.3485785,0.3485785,0.3485785,
                        0.3485785,0.3485785,0.3485785,0.3077690,0.3485785,0.3077690,
                        0.3485785,0.3485785,0.3077690,0.3485785,0.3485785,0.3485785,
                        0.3485785,0.3485785,0.3485785,0.3485785,0.3485785,0.3077690,
                        0.3077690,0.3485785,0.3077690,0.3485785)
  ari.pcaReduce.median.treu<-median(ari.pcaReduce.treu)
  
  ari.sincera.treu<-c(0.09411925)###########30类
  
  
  
  ##################################deng
  
  ari.linnorm.deng<-c(0.599243,0.5951692,0.6084367,0.589767,0.5878698,0.6161508,0.5997935,
                      0.6082128,0.5834757,0.6002155,0.5988397,0.6086045,0.6204495,0.5884164,
                      0.5837899,0.6212943,0.6069616,0.6166941,0.5905982,0.5889823,0.5963812,
                      0.6042064,0.6039241,0.6122043,0.6049108,0.6305102,0.581038,0.6053909,
                      0.5578615,0.5719906,0.610075,0.5438881,0.6082741,0.5967407,0.5938365,
                      0.6086896,0.5995587,0.5745606,0.5955154,0.6042604,0.5958758,0.5959453,
                      0.6053909,0.5881258,0.5837817,0.6032033,0.5968273,0.5918482,0.5966949,
                      0.601231,0.5663986,0.57843,0.5933499,0.5863103,0.5905278,0.5935627,
                      0.6199945,0.5865295,0.5901732,0.5862672,0.6140785,0.609286,0.603519,
                      0.6026029,0.5996313,0.5987941,0.6089765,0.5894337,0.5848338,0.648044,
                      0.595587,0.5597984,0.5951692,0.5959479,0.5954681,0.6033084,0.5832363,
                      0.595587,0.6009193,0.5990265,0.6107864,0.6036506,0.5918918,0.5850787,
                      0.6042604,0.6075548,0.6039706,0.5662944,0.6075548,0.595587,0.5931456,
                      0.6093345,0.6025486,0.6064851,0.6128547,0.5800983,0.6174776,0.5936752,
                      0.6140785,0.5878835)##########################13lei  95.9%
  #c(0.5706332,0.5892190,0.5841692,0.5809792,0.5606481,0.5557812
  #,0.5780363,0.6118313,0.5759087,0.6776555,0.5811263,0.5668407
  #,0.6085654,0.5824035,0.6297359,0.5854032,0.5785037,0.5607107
  #,0.6696685,0.5811263,0.5780363,0.5786483,0.5072119,0.5763886
  #,0.5855767,0.5777578,0.5532443,0.5726131,0.5809792,0.5725833
  #,0.6886570,0.5780363,0.5724227,0.5628876,0.5792468,0.6414948
  #,0.6219687,0.5733589,0.5809792,0.5821150,0.6461570,0.6372253
  #,0.5815062,0.5751983,0.6254465,0.6104655,0.6393006,0.5855767
  #,0.5736025,0.5785525,0.5625597,0.5560854,0.5738598,0.5769994
  #,0.5628876,0.5726841,0.5809792,0.5831810,0.6361595,0.6205008
  #,0.5769994,0.5733589,0.5647785,0.5825417,0.5769994,0.6393006
  #,0.6234314,0.6323044,0.6297472,0.6952820,0.6862844,0.5774495
  #,0.5684567,0.5769994,0.6425465,0.5733589,0.5733589,0.5823740
  #,0.5768710,0.5918202,0.5811263,0.5572973,0.5635440,0.5771924
  #,0.5622903,0.5794550,0.5875571,0.5769994,0.6313159,0.5823740
  #,0.5780363,0.5780363,0.5875571,0.5791442,0.6397644,0.7065776
  #,0.5809792,0.5824035,0.5779262,0.5699416)###########################10lei  95%
  ari.linnorm.median.deng<-median(ari.linnorm.deng)
  
  ari.pcaReduce.deng<-c(0.4123278,0.4590581,0.3881274,0.3889301,0.3889301,0.4201739
                        ,0.4263303,0.3889301,0.3556826,0.3638339,0.4820894,0.4881865
                        ,0.4263303,0.4476014,0.3971804,0.3881274,0.4459349,0.3881274
                        ,0.3881274,0.3900325,0.4278689,0.3900325,0.3630403,0.4069758
                        ,0.4263303,0.3540631,0.3735114,0.4201739,0.3193085,0.3803279
                        ,0.4201739,0.3910822,0.3881274,0.4011055,0.3932246,0.3881274
                        ,0.4263303,0.3467780,0.3904328,0.3115153,0.3412817,0.4201739
                        ,0.4245093,0.4903337,0.3798122,0.4614178,0.4131913,0.4073746
                        ,0.4069758,0.3670046,0.4241481,0.3881274,0.3638339,0.3627037
                        ,0.3883160,0.3932246,0.3539865,0.4123278,0.4783978,0.4580230
                        ,0.4382881,0.4081815,0.3670046,0.4326609,0.4171620,0.3461144
                        ,0.4210879,0.4011055,0.4220831,0.4783978,0.4020203,0.3917802
                        ,0.4382881,0.3910822,0.4201739,0.4020203,0.3638339,0.4212085
                        ,0.4198592,0.3638339,0.4234388,0.4131913,0.4011055,0.4201739
                        ,0.3586938,0.3889301,0.4783978,0.3900325,0.4361625,0.4702417
                        ,0.3539865,0.3803279,0.3670046,0.3881274,0.4201739,0.3586938
                        ,0.3932246,0.3971804,0.4020966,0.4376561)
  
  ari.pcaReduce.median.deng<-median(ari.pcaReduce.deng)
  
  ari.sc3.deng<-c(0.6821716,0.7984287,0.6822109,0.7984287,0.7984287,0.7984287,0.7984287,0.7984287,0.7984287,
                  0.7984287,0.7984287,0.6821716,0.6821716,0.6822109,0.7984287,0.7984287,0.6822109,0.7984287,
                  0.7984287,0.7977718,0.7984287,0.7984287,0.7984287,0.7984287,0.8107421,0.7984287,0.7984287,
                  0.7984287,0.6821716,0.7984287,0.7984287,0.6822109,0.7977718,0.7984287,0.7984287,0.6822109,
                  0.7984287,0.7984287,0.7984287,0.7984287,0.7984287,0.7984287,0.7977718,0.7984287,0.7984287,
                  0.6822109,0.7984287,0.7984287,0.7984287,0.7984287,0.7984287,0.6822109,0.7984287,0.6822109,
                  0.7984287,0.6822109,0.7984287,0.6822109,0.7984287,0.7984287,0.7984287,0.7984287,0.7984287,
                  0.7984287,0.6822109,0.7984287,0.7984287,0.7984287,0.7984287,0.7984287,0.7984287,0.7984287,
                  0.7984287,0.7984287,0.7977718,0.7984287,0.7984287,0.6822109,0.7984287,0.7984287,0.6822109,
                  0.7977718,0.7984287,0.7984287,0.7984287,0.7984287,0.7984287,0.7957574,0.7977718,0.7984287,
                  0.7984287,0.6822109,0.7984287,0.7984287,0.7984287,0.7984287,0.7984287,0.7984287,0.7984287,0.6822109)
  
  ari.sc3.median.deng<-median(ari.sc3.deng)
  
  ari.sincera.deng<-c(0.4262627)##########4类
  
  
  #####################################goolam
  ari.linnorm.goolam<-c(0.8830845,0.8830845,0.8746762,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8746762,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,0.8830845,
                        0.8830845,0.8830845)
  
  ari.linnorm.median.goolam<-median(ari.linnorm.goolam)
  
  ari.pcaReduce.goolam<-c(0.16758116,0.27211554,0.24614616,0.16758116,0.20708118
                          ,0.24614616,0.27046470,0.16758116,0.30282325,0.27046470
                          ,0.27046470,0.22435275,0.24614616,0.27046470,0.24614616
                          ,0.24614616,0.24614616,0.24614616,0.16758116,0.27046470
                          ,0.16758116,0.28112116,0.22435275,0.22435275,0.30529620
                          ,0.16758116,0.22435275,0.27046470,0.22435275,0.27211554
                          ,0.27211554,0.22435275,0.24614616,0.24614616,0.16758116
                          ,0.24614616,0.24614616,0.22435275,0.16758116,0.27211554
                          ,0.27046470,0.20708118,0.30529620,0.24614616,0.16758116
                          ,0.24614616,0.30282325,0.22435275,0.13782490,0.22435275
                          ,0.30282325,0.27046470,0.20708118,0.13782490,0.30529620
                          ,0.24614616,0.18626272,0.16758116,0.24614616,0.16758116
                          ,0.27211554,0.27046470,0.27211554,0.24614616,0.24614616
                          ,0.27046470,0.16758116,0.16758116,0.18626272,0.16758116
                          ,0.27046470,0.22435275,0.14842204,0.10379343,0.22435275
                          ,0.13782490,0.22435275,0.27046470,0.21932303,0.24614616
                          ,0.24614616,0.16758116,0.22435275,0.22435275,0.13782490
                          ,0.16758116,0.18626272,0.27046470,0.24614616,0.16758116
                          ,0.30529620,0.16758116,0.27046470,0.24614616,0.22435275
                          ,0.24614616,0.24614616,0.24614616,0.24614616,0.06110472)
  
  ari.pcaReduce.median.goolam<-median(ari.pcaReduce.goolam)
  
  ari.sc3.goolam<-c(0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447,0.5973447
                    ,0.5973447,0.5973447,0.5973447,0.5973447)
  
  ari.sc3.median.goolam<-median(ari.sc3.goolam)
  
  ari.sincera.goolam<-c(0.354832)###############4类
  
  
  #######################################SINCERA
  
  ari.linnorm.sincera<-c(0.4697203,0.4053446,0.4489427,0.408678,0.4608923,0.4325345,0.491732,0.4981633,0.4343475,
                         0.4870921,0.4388778,0.4649928,0.5881783,0.4877152,0.4574231,0.5127039,0.4403741,0.4788185,
                         0.4687432,0.4289495,0.4990603,0.4807597,0.4105674,0.4456491,0.4873323,0.4438458,0.5178236,
                         0.5992235,0.4560072,0.520291,0.3965617,0.4366216,0.4929513,0.5047416,0.3992341,0.5380632,
                         0.5020279,0.4576466,0.4747281,0.5112538,0.5260956,0.5540305,0.4459671,0.4432621,0.4742917,
                         0.5019149,0.4694758,0.4651015,0.4794786,0.4851594,0.5504037,0.436712,0.4762087,0.4518168,
                         0.497202,0.4823138,0.4382557,0.482069,0.5260169,0.5083173,0.5008536,0.5688772,0.4741521,
                         0.5049051,0.5224943,0.4682908,0.4119945,0.4596471,0.5075822,0.4880522,0.5168316,0.4497057,
                         0.4729463,0.5382248,0.4447797,0.4625358,0.5489487,0.5190731,0.4700518,0.4507822,0.4988308,
                         0.4373022,0.4907692,0.4610133,0.4577235,0.4972358,0.4840708,0.5147602,0.5126733,0.4966653,
                         0.4657134,0.5440611,0.4656127,0.5222753,0.4246572,0.4528921,0.4467633,0.5443124,0.5477156,
                         0.4300932)
  
  ari.linnorm.median.sincera<-median(ari.linnorm.sincera)
  
  ari.pcaReduce.sincera<-c(0.08615472,0.09536037,0.07605938,0.08615472,0.08615472,
                           0.08217412,0.08615472,0.08793253,0.08615472,0.08615472,
                           0.08091615,0.08092047,0.07605938,0.08793253,0.08615472,
                           0.08615472,0.07605938,0.08615472,0.08347711,0.08615472,
                           0.08615472,0.08615472,0.08182803,0.08347711,0.07742479,
                           0.08793253,0.08615472,0.09343973,0.08849724,0.08615472,
                           0.09536037,0.08615472,0.08429252,0.08615472,0.08615472,
                           0.08615472,0.09005741,0.07406854,0.08615472,0.07762930,
                           0.08092047,0.09536037,0.08615472,0.07856175,0.08236340,
                           0.08092047,0.08906348,0.09005741,0.08615472,0.08615472,
                           0.07856175,0.07742479,0.08615472,0.08793253,0.08615472,
                           0.08615472,0.08615472,0.08429252,0.08793253,0.08615472,
                           0.07762930,0.08615472,0.08892326,0.07605938,0.08347711,
                           0.08347711,0.08615472,0.08615472,0.08049275,0.07856175,
                           0.09343973,0.09536037,0.08615472,0.08615472,0.08091615,
                           0.06886392,0.08615472,0.07605938,0.09055364,0.08892326,
                           0.08615472,0.07762930,0.07605938,0.08347711,0.08615472,
                           0.08615472,0.08774273,0.08324202,0.09005741,0.08347711,
                           0.06886392,0.08182803,0.09005741,0.08253837,0.08976336,
                           0.08615472,0.08615472,0.08637841,0.09808555,0.08092047)
  
  ari.pcaReduce.median.sincera<-median(ari.pcaReduce.sincera)
  
  ari.sc3.sincera<-c(0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,
                     0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,
                     0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,
                     0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,
                     0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,
                     0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,
                     0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,
                     0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,
                     0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,
                     0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545,0.4937545)
  
  ari.sc3.median.sincera<-median(ari.sc3.sincera)
  
  ari.sincera.sincera<-c(1.0)  
  
  
  group<-factor(c(rep("my method",100),rep("pcaReduce",100),rep("SC3",100),"sincera"))
  ari1<-c(ari.linnorm.goolam,ari.pcaReduce.goolam,ari.sc3.goolam,ari.sincera.goolam)
  ari2<-c(ari.linnorm.deng,ari.pcaReduce.deng,ari.sc3.deng,ari.sincera.deng)
  ari3<-c(ari.linnorm.biase,ari.pcaReduce.biase,ari.sc3.biase,ari.sincera.biase)
  ari4<-c(ari.linnorm.sincera,ari.pcaReduce.sincera,ari.sc3.sincera,ari.sincera.sincera)
  ari5<-c(ari.linnorm.treu,ari.pcaReduce.treu,ari.sc3.treu,ari.sincera.treu)
  ari6<-c(ari.linnorm.yan,ari.pcaReduce.yan,ari.sc3.yan,ari.sincera.yan)
  
  ARI1<-data.frame(ari1,group)
  ARI2<-data.frame(ari2,group)
  ARI3<-data.frame(ari3,group)
  ARI4<-data.frame(ari4,group)
  ARI5<-data.frame(ari5,group)
  ARI6<-data.frame(ari6,group)
  # ggplot(data=ARI,aes(x=group,y=ari))+
  #   geom_point(position="jitter")+
  #  stat_summary(fun.y=median,geom='bar')
  
  
  
  ggplot(data=ARI1,aes(x=group,y=ari1))+
    geom_bar(fun.y=median,stat="summary",fill=c("red","green","yellow","cornflowerblue"))+
    ylim(0,1)+
    geom_point(position="jitter")+
    labs(title="dataset goolam",y="ARI")+
    theme(plot.title = element_text(hjust = 0.5))
  #  theme_bw() + 
  #  theme(panel.border = element_blank(),panel.grid.major = element_blank(),
  #        panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
  
  ggplot(data=ARI2,aes(x=group,y=ari2))+
    geom_bar(fun.y=median,stat="summary",fill=c("red","green","yellow","cornflowerblue"))+
    ylim(0,1)+
    geom_point(position="jitter")+
    labs(title="dataset deng",y="ARI")+
    theme(plot.title = element_text(hjust = 0.5))
  # theme_bw() + 
  #  theme(panel.border = element_blank(),panel.grid.major = element_blank(),
  #        panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))    
  
  ggplot(data=ARI3,aes(x=group,y=ari3))+
    geom_bar(fun.y=median,stat="summary",fill=c("red","green","yellow","cornflowerblue"))+
    ylim(0,1.05)+
    geom_point(position="jitter")+
    labs(title="dataset biase",y="ARI")+
    theme(plot.title = element_text(hjust = 0.5))
  #  theme_bw() + 
  #  theme(panel.border = element_blank(),panel.grid.major = element_blank(),
  #        panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
  
  
  ggplot(data=ARI4,aes(x=group,y=ari4))+
    geom_bar(fun.y=median,stat="summary",fill=c("red","green","yellow","cornflowerblue"))+
    ylim(0,1.01)+
    geom_point(position="jitter")+
    labs(title="dataset sincera",y="ARI")+
    theme(plot.title = element_text(hjust = 0.5))
  #  theme_bw() + 
  #  theme(panel.border = element_blank(),panel.grid.major = element_blank(),
  #        panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
  
  
  ggplot(data=ARI5,aes(x=group,y=ari5))+
    geom_bar(fun.y=median,stat="summary",fill=c("red","green","yellow","cornflowerblue"))+
    ylim(0,1)+
    geom_point(position="jitter")+
    labs(title="dataset treutlein",y="ARI")+
    theme(plot.title = element_text(hjust = 0.5))
  #  theme_bw() + 
  #  theme(panel.border = element_blank(),panel.grid.major = element_blank(),
  #        panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
  
  
  ggplot(data=ARI6,aes(x=group,y=ari6))+
    geom_bar(fun.y=median,stat="summary",fill=c("red","green","yellow","cornflowerblue"))+
    ylim(0,1)+
    geom_point(position="jitter")+
    labs(title="dataset yan",y="ARI")+
    theme(plot.title = element_text(hjust = 0.5))
  #  theme_bw() + 
  #  theme(panel.border = element_blank(),panel.grid.major = element_blank(),
  #        panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
  
  
 ###数据汇总
  datagroup<-factor(c(rep("goolam",301),rep("deng",301),rep("biase",301),
                      rep("sincera",301),rep("treulein",301),rep("yan",301)))
  hari<-c(ari.linnorm.goolam,ari.pcaReduce.goolam,ari.sc3.goolam,ari.sincera.goolam,
         ari.linnorm.deng,ari.pcaReduce.deng,ari.sc3.deng,ari.sincera.deng,
         ari.linnorm.biase,ari.pcaReduce.biase,ari.sc3.biase,ari.sincera.biase,
         ari.linnorm.sincera,ari.pcaReduce.sincera,ari.sc3.sincera,ari.sincera.sincera,
         ari.linnorm.treu,ari.pcaReduce.treu,ari.sc3.treu,ari.sincera.treu,
         ari.linnorm.yan,ari.pcaReduce.yan,ari.sc3.yan,ari.sincera.yan) 
  methodgroup<-factor(rep(c(rep("PEMC",100),rep("pcaReduce",100),rep("SC3",100),"Sincera"),6))    
  hARI<-data.frame(hari,methodgroup,datagroup)
  hARI1 <- within(hARI,{
    methodgroup <- factor(methodgroup,levels = c("PEMC","pcaReduce","SC3","Sincera"))
  })                
###绘图
ggplot(data=hARI1,aes(x=methodgroup,y=hari))+
       geom_bar(fun.y=median,stat="summary",aes(fill=methodgroup))+
       geom_point(position="jitter",size=1)+
       labs(title="comparison",x="Method",y="ARI")+
       guides(fill=guide_legend(title="Method"))+
       theme(plot.title = element_text(size=36,hjust=0.5),
             axis.title.x=element_text(size=20,hjust=0.5),
             axis.title.y=element_text(size=20,hjust=0.5),
             axis.text.x=element_text(size=16,angle=30,vjust=0.5),
             panel.background = element_blank())+
       theme(axis.line = element_line(size=1, colour = "black"))+
       facet_grid(.~datagroup)
  
  
  
  
  